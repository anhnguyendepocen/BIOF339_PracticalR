---
title: "Lecture 3 Practicum"
author: "BIOF 339"
date: "9/26/2018"
output: html_document
---

```{r, echo=F}
knitr::opts_chunk$set(eval=F, echo=T)
```

We will use data from a gene expression experiment on chronic lymphocytic leukemia (CLL) patients, available from Bioconductor. You can download the data
[here](https://dl.dropboxusercontent.com/s/op4ehzkc7ery96l/geneexpressions.csv)

1. Read the data into R using the `read_csv` function from the `readr` package, part of the `tidyverse` metapackage.
```{r}
suppressPackageStartupMessages(library(tidyverse))
link <- 'https://dl.dropboxusercontent.com/s/op4ehzkc7ery96l/geneexpressions.csv'
download.file(link,'geneexpressions.csv')
dat <- read_csv('geneexpressions.csv')
```

2. This data set contains some Affymetrix control probes that we want to exclude. These are in columns with names starting with "AFFX". Let's exclude these from further analysis. Save the result to a new data frame (i.e. give it a new name)
```{r}
dat2 <- dat %>% select(-starts_with('AFFX'))
```

3. The first two columns are the sample IDs and the disease phenotypes. The rest are expressions from the probesets. Let's make this dataset tidy using `gather`, but making sure that we keep the `SampleID` and `Disease` columns intact and repeated over the rows of each probeset's data.

```{r}
dat3 <- dat2 %>% gather(probe, value, -SampleID, -Disease)
```

4. Filter out the rows with missing disease status

```{r}
dat3 <- dat3 %>% filter(!is.na(Disease))
```


----

## Note
 
 I created the dataset used here using the following code:
 
```{r, eval=F, echo=T}
source('http://bioconductor.org/biocLite.R')
biocLite('CLL')
library(CLL)
library(affy)
data(CLLBatch)
data(disease)
d <-  rma(CLLbatch)
dat <- t(as.data.frame(exprs(d)))
dat <- cbind(disease, dat)
write.csv(dat, file='geneexpressions.csv', row.names = F)

```
 
